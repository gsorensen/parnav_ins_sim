# INS Factor Graph Optimisation Scheme

## Dependencies

- CMake
- Conan 
- fmt
- Eigen


Dependencies can be installed via Homebrew on macOS and (I assume) your
favourite package manager on Linux distros.

## Defining path prefixes

Currently it is necessary to set up the path prefixes for fetching and saving
data in the code. This is done in the `get_filenames` function found in
`main.cpp`. Make note of the fact that it is necessary to have the last
forward-slash in this prefix, since the remaining path is appended without this.

The output expects a given structure. By default, the data and results folders
are at the same level as the root directory of this project, since this is
generated by code in the ins_mekf repo, and results are parsed from the same
repo. This should be maintained, since the paths used in the `plotting/plot_results.m`
script in Matlab uses relative paths which assumes these folders are at the same
level of `ins_mekf`.

This structure is as follows:
- results
    - dummy 
        - mekf 
        - fgo_fixed_lag
    - otter 
        - mekf 
        - fgo_fixed_lag 
    - standstill
        - mekf 
        - fgo_fixed_lag 

There is no need to create folders for the programs you don't intend to run.

## Setting the noise parameters

Currently the noise parameters that were used to generate the data (for IMU,
GNSS, PARS) aren't parsed and set automatically. If these are changed, it is
necessary to update the variables in the code. This is done in the
`initialise_sensors` function in `main.cpp` 

## Building

The scripts are rather simple, just automates the commands needed. Should be run
in this order (all from root directory of ins_fgo):
1. install_conan_packages.sh 
2. setup_cmake.sh 

If you want to build for debug, run the scripts with the _debug suffix. This
will create a separate build_debug folder. This will run slowly, but there is
some additional debug output that may be useful. The scripts should be run
whenever dependencies change.

After this navigate to build (or build_debug) and simply run `ninja`

## Running 

The Cmake project sets up multiple projects depending on what case is being
tested. Currently, only fixed lag is really considered. 

The desired program is run with the standard "./" notation in the terminal.

## Notes

Project structure is based off of the tutorial from Conan's documentation
[here](https://docs.conan.io/2.0/tutorial/consuming_packages/build_simple_cmake_project.html). The build scripts here are for Linux/macOS, and will not work on Windows. 
